---
import '../theme/base.css';
import '../theme/index.css';
import { getCollection } from 'astro:content';
import ThemeToggle from '../components/ThemeToggle.astro';
import SmoothScroll from '../components/SmoothScroll.astro';

const posts = (await getCollection('blog', ({ data }) => {
  return import.meta.env.PROD ? data.draft !== true : true;
})).sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf());
---

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Blog</title>
  </head>
  <body>
    <ThemeToggle />
    <SmoothScroll />
    <h1>Blog</h1>
    <ul>
      {posts.map((post) => (
        <li>
          <a href={`${import.meta.env.BASE_URL}${post.id}/`}>
            {post.data.title}
          </a>
          {' '}
          <time datetime={post.data.date.toISOString()}>
            ({post.data.date.toLocaleDateString('en-US', { year: 'numeric', month: 'short', day: 'numeric' })})
          </time>
        </li>
      ))}
    </ul>
  </body>
</html>
